/******************************************************************************/
/*						Base Final - alavancas								  */
/******************************************************************************/

clear all
set more off, permanently
capture log close


capture log close
global user "`:environment USERPROFILE'"
*global Folder "$user/OneDrive/EESP_ECONOMIA_mestrado_acadêmico/Dissertação/ICE/dados_ICE/Análise_Leonardo"
global Folder "C:\Users\Leonardo.idea-PC\OneDrive\EESP_ECONOMIA_mestrado_acadêmico\Dissertação\ICE\dados_ICE\Análise_Leonardo"
global output "$Folder/resultados"
global Bases "$Folder/Bases"
global dofiles "$Folder/Do-Files"
global Logfolder "$Folder/Log"

global folderservidor "\\fs-eesp-01\EESP\Usuarios\leonardo.kawahara"



log using "$folderservidor\logfiles/new_merge_nota_alavancas.log", replace

/*
tirando da base ice_clean_nota escolas tratadas que não tem dados ou de alavancas
ou de dados ice
*/

use "$folderservidor\ice_clean_notas.dta", clear

/*
* 9 escolas estão somente na base de alavancas
* 95 escolas estão somente na base inicial do ice
*/
* não percebe-se nenhum padrão das escolas que estavam na base inicial do ice, mas não estavam na base de alavancas
drop if (ice==1 &(al_engaj_gov == .  & al_engaj_sec ==. & al_time_seduc==. & al_marcos_lei==. & al_todos_marcos==. & al_sel_dir==. & al_sel_prof==. & al_proj_vida==. ))
* (1,097 observations deleted)
* no painel, cada escola aparece em até 13 vezes na base. então esse número faz sentido
* olhando na base, escolas que não estavam na base inical do ice, mas estavam na base alavancas são aquelas que estavam no mais educação, em geral
drop if (al_engaj_gov!=. & al_engaj_sec!=. & al_time_seduc!=.&  al_marcos_lei!=. &  al_todos_marcos!=. &  al_sel_dir!=.& al_sel_prof!=.& al_proj_vida!=.&ice_jornada==""& ice_segmento==""& ice_rigor=="" &ano_ice==.& ensino_fundamental==. &  integral==.&ice_2004 ==. & ice_2005==. & ice_2006==. & ice_2007==. & ice_2008 == . & ice_2009==. & ice_2010==. & ice_2011==. & ice_2012==. & ice_2013==. & ice_2014==. & ice_2015==.)
* (95 observations deleted)
* no painel, cada escola aparece em até 13 vezes na base. então esse número faz sentido

/*mantendo somente variáveis que vão ser utilizadas*/


*keep uf nome_municipio  nome_escola  codigo_escola  al_engaj_gov  al_engaj_sec  al_time_seduc  al_marcos_lei  al_todos_marcos  al_sel_dir  al_sel_prof  al_proj_vida  ice_jornada  ice_segmento  ano_ice  ice_rigor  ice  ensino_fundamental    ice_2004  ice_2005  ice_2006  ice_2007  ice_2008  ice_2009  ice_2010  ice_2011  ice_2012  ice_2013  ice_2014  ice_2015  integral  mais_educacao_fund_2010    mais_educacao_med_2009    mais_educacao_med_2010    mais_educacao_x_2012    mais_educacao_x_2008    mais_educacao_x_2014    mais_educacao_fund_2013    mais_educacao_fund_2014    mais_educacao_fund_2009    mais_educacao_fund_2011    mais_educacao_fund_2012    mais_educacao_med_2011    mais_educacao_x_2009    mascara  concluir_em_ano_enem    ano  enem_nota_objetiva    enem_nota_redacao    e_mora_mais_de_6_pessoas    e_tem_filho  e_escol_sup_pai  e_escol_sup_mae  e_renda_familia_5_salarios    e_automovel  e_casa_propria  insc_regular_enem    presentes_enem  insc_prof_enem  enem_nota_ciencias    enem_nota_humanas    enem_nota_linguagens    enem_nota_matematica    e_mora_mais_de_7_pessoas    e_renda_familia_6_salarios    e_trabalhou  media_lp_prova_brasil_9    media_mt_prova_brasil_9    pb_n_partic*  pb_esc_sup_mae*  pb_esc_sup_pai* pb_metodo_esc_dir_selecao    pb_metodo_esc_dir_eleicao    pb_metodo_esc_dir_sel_ele    pb_metodo_esc_dir_indic    pb_exp_prof_mais_3_9    pb_exp_prof_escola_mais_3_9    taxa_participacao_pb*    pb_comp_internet_9    pb_empregada_diarista_9    pb_exp_prof_mais_2_9    pb_exp_prof_escola_mais_2_9    pb_empregada_5vez_9    dist_ef  dist_em  apr_ef  apr_em  rep_ef  rep_em  aba_ef  aba_em  codigo_uf  sigla  codigo_municipio_novo    distrito_escola_novo    dependencia_administrativa    n_salas_exis  n_salas_utilizadas    ativa  rural  predio  agua  eletricidade  esgoto  lixo_coleta  diretoria  sala_professores    lab_info  lab_ciencias  quadra_esportes  biblioteca  sala_leitura  refeitorio  internet  regular  fund_8_anos  fund_9_anos  em  em_integrado  em_normal  em_prof  codigo_municipio_enorme    codigo_municipios    UF  n_copiadoras  n_arsalas  n_impressoras  n_salas_perm  n_salas_prov  n_sala_util  n_sala_util_fora    codigo_municipio    ufmundv  nomemun  _merge  d_dep1  d_dep2  d_dep3  d_dep4  mais_educ  d_rigor1  d_rigor2  d_rigor3  d_rigor4  media_pb_9  enem_nota_matematica_std    enem_nota_ciencias_std    enem_nota_humanas_std    enem_nota_linguagens_std    media_lp_prova_brasil_9_std    media_mt_prova_brasil_9_std    media_pb_9_std  apr_ef_std  apr_em_std  rep_ef_std  rep_em_std  aba_ef_std  aba_em_std  dist_ef_std  dist_em_std  enem_nota_redacao_std_aux_2003    enem_nota_redacao_std_aux_2004    enem_nota_redacao_std_aux_2005    enem_nota_redacao_std_aux_2006    enem_nota_redacao_std_aux_2007    enem_nota_redacao_std_aux_2008    enem_nota_redacao_std    enem_nota_objetiva_std_aux_2003    enem_nota_objetiva_std_aux_2004    enem_nota_objetiva_std_aux_2005    enem_nota_objetiva_std_aux_2006    enem_nota_objetiva_std_aux_2007    enem_nota_objetiva_std_aux_2008    enem_nota_objetivab    enem_nota_objetivab_std    enem_nota_matematica26_std    enem_nota_ciencias26_std    enem_nota_humanas26_std    enem_nota_linguagens26_std    media_lp_prova_brasil_926_std    media_mt_prova_brasil_926_std    media_pb_926_std    apr_ef26_std  apr_em26_std  rep_ef26_std  rep_em26_std  aba_ef26_std  aba_em26_std  dist_ef26_std  dist_em26_std  enem_nota_matematica52_std    enem_nota_ciencias52_std    enem_nota_humanas52_std    enem_nota_linguagens52_std    media_lp_prova_brasil_952_std    media_mt_prova_brasil_952_std    media_pb_952_std    apr_ef52_std  apr_em52_std  rep_ef52_std  rep_em52_std  aba_ef52_std  aba_em52_std  dist_ef52_std  dist_em52_std  enem_nota_matematica35_std    enem_nota_ciencias35_std    enem_nota_humanas35_std    enem_nota_linguagens35_std    media_lp_prova_brasil_935_std    media_mt_prova_brasil_935_std    media_pb_935_std    apr_ef35_std  apr_em35_std  rep_ef35_std  rep_em35_std  aba_ef35_std  aba_em35_std  dist_ef35_std  dist_em35_std  enem_nota_matematica23_std    enem_nota_ciencias23_std    enem_nota_humanas23_std    enem_nota_linguagens23_std    media_lp_prova_brasil_923_std    media_mt_prova_brasil_923_std    media_pb_923_std    apr_ef23_std  apr_em23_std  rep_ef23_std  rep_em23_std  aba_ef23_std  aba_em23_std  dist_ef23_std  dist_em23_std  enem_nota_matematica33_std    enem_nota_ciencias33_std    enem_nota_humanas33_std    enem_nota_linguagens33_std    media_lp_prova_brasil_933_std    media_mt_prova_brasil_933_std    media_pb_933_std    apr_ef33_std  apr_em33_std  rep_ef33_std  rep_em33_std  aba_ef33_std  aba_em33_std  dist_ef33_std  dist_em33_std  enem_nota_redacao26_std_aux_2003    enem_nota_redacao26_std_aux_2004    enem_nota_redacao26_std_aux_2005    enem_nota_redacao26_std_aux_2006    enem_nota_redacao26_std_aux_2007    enem_nota_redacao26_std_aux_2008    enem_nota_redacao26_std    enem_nota_objetivab26    enem_nota_objetivab26_std    enem_nota_redacao52_std_aux_2003    enem_nota_redacao52_std_aux_2004    enem_nota_redacao52_std_aux_2005    enem_nota_redacao52_std_aux_2006    enem_nota_redacao52_std_aux_2007    enem_nota_redacao52_std_aux_2008    enem_nota_redacao52_std    enem_nota_objetivab52    enem_nota_objetivab52_std    enem_nota_redacao35_std_aux_2003    enem_nota_redacao35_std_aux_2004    enem_nota_redacao35_std_aux_2005    enem_nota_redacao35_std_aux_2006    enem_nota_redacao35_std_aux_2007    enem_nota_redacao35_std_aux_2008    enem_nota_redacao35_std    enem_nota_objetivab35    enem_nota_objetivab35_std    enem_nota_redacao23_std_aux_2003    enem_nota_redacao23_std_aux_2004    enem_nota_redacao23_std_aux_2005    enem_nota_redacao23_std_aux_2006    enem_nota_redacao23_std_aux_2007    enem_nota_redacao23_std_aux_2008    enem_nota_redacao23_std    enem_nota_objetivab23    enem_nota_objetivab23_std    enem_nota_redacao33_std_aux_2003    enem_nota_redacao33_std_aux_2004    enem_nota_redacao33_std_aux_2005    enem_nota_redacao33_std_aux_2006    enem_nota_redacao33_std_aux_2007    enem_nota_redacao33_std_aux_2008    enem_nota_redacao33_std    enem_nota_objetivab33    enem_nota_objetivab33_std    n_alunos_em  n_mulheres_em  n_brancos_em  n_alunos_ef  n_mulheres_ef  n_brancos_ef  n_alunos_ep  n_mulheres_ep  n_brancos_ep  n_alunos_ef_em  n_alunos_em_ep  n_alunos_ef_em_ep    n_mulheres_ef_em_ep    n_brancos_ef_em_ep    d_ice  d_ano1  d_ano2  d_ano3  d_ano4  d_ano5  d_ano6  d_ano7  d_ano8  d_ano9  d_ano10  d_ano11  d_ano12  d_uf1  d_uf2  d_uf3  d_uf4  d_uf5  nalunos  nmulheres  nbrancos  taxa_participacao_enem_aux    taxa_participacao_enem_aux2    taxa_participacao_enem    
save "$folderservidor\ice_clean_notas_alavancas.dta", replace


use "$folderservidor\ice_clean_fluxo.dta", clear

/*
* 9 escolas estão somente na base de alavancas
* 95 escolas estão somente na base inicial do ice
*/
* não percebe-se nenhum padrão das escolas que estavam na base inicial do ice, mas não estavam na base de alavancas
drop if (ice==1 &(al_engaj_gov == .  & al_engaj_sec ==. & al_time_seduc==. & al_marcos_lei==. & al_todos_marcos==. & al_sel_dir==. & al_sel_prof==. & al_proj_vida==. ))
* (1,097 observations deleted)
* no painel, cada escola aparece em até 13 vezes na base. então esse número faz sentido
* olhando na base, escolas que não estavam na base inical do ice, mas estavam na base alavancas são aquelas que estavam no mais educação, em geral
drop if (al_engaj_gov!=. & al_engaj_sec!=. & al_time_seduc!=.&  al_marcos_lei!=. &  al_todos_marcos!=. &  al_sel_dir!=.& al_sel_prof!=.& al_proj_vida!=.&ice_jornada==""& ice_segmento==""& ice_rigor=="" &ano_ice==.& ensino_fundamental==. &  integral==.&ice_2004 ==. & ice_2005==. & ice_2006==. & ice_2007==. & ice_2008 == . & ice_2009==. & ice_2010==. & ice_2011==. & ice_2012==. & ice_2013==. & ice_2014==. & ice_2015==.)
* (95 observations deleted)
* no painel, cada escola aparece em até 13 vezes na base. então esse número faz sentido

/*mantendo somente variáveis que vão ser utilizadas*/


*keep uf nome_municipio  nome_escola  codigo_escola  al_engaj_gov  al_engaj_sec  al_time_seduc  al_marcos_lei  al_todos_marcos  al_sel_dir  al_sel_prof  al_proj_vida  ice_jornada  ice_segmento  ano_ice  ice_rigor  ice  ensino_fundamental    ice_2004  ice_2005  ice_2006  ice_2007  ice_2008  ice_2009  ice_2010  ice_2011  ice_2012  ice_2013  ice_2014  ice_2015  integral  mais_educacao_fund_2010    mais_educacao_med_2009    mais_educacao_med_2010    mais_educacao_x_2012    mais_educacao_x_2008    mais_educacao_x_2014    mais_educacao_fund_2013    mais_educacao_fund_2014    mais_educacao_fund_2009    mais_educacao_fund_2011    mais_educacao_fund_2012    mais_educacao_med_2011    mais_educacao_x_2009    mascara  concluir_em_ano_enem    ano  enem_nota_objetiva    enem_nota_redacao    e_mora_mais_de_6_pessoas    e_tem_filho  e_escol_sup_pai  e_escol_sup_mae  e_renda_familia_5_salarios    e_automovel  e_casa_propria  insc_regular_enem    presentes_enem  insc_prof_enem  enem_nota_ciencias    enem_nota_humanas    enem_nota_linguagens    enem_nota_matematica    e_mora_mais_de_7_pessoas    e_renda_familia_6_salarios    e_trabalhou  media_lp_prova_brasil_9    media_mt_prova_brasil_9    pb_n_partic*  pb_esc_sup_mae*  pb_esc_sup_pai* pb_metodo_esc_dir_selecao    pb_metodo_esc_dir_eleicao    pb_metodo_esc_dir_sel_ele    pb_metodo_esc_dir_indic    pb_exp_prof_mais_3_9    pb_exp_prof_escola_mais_3_9    taxa_participacao_pb*    pb_comp_internet_9    pb_empregada_diarista_9    pb_exp_prof_mais_2_9    pb_exp_prof_escola_mais_2_9    pb_empregada_5vez_9    dist_ef  dist_em  apr_ef  apr_em  rep_ef  rep_em  aba_ef  aba_em  codigo_uf  sigla  codigo_municipio_novo    distrito_escola_novo    dependencia_administrativa    n_salas_exis  n_salas_utilizadas    ativa  rural  predio  agua  eletricidade  esgoto  lixo_coleta  diretoria  sala_professores    lab_info  lab_ciencias  quadra_esportes  biblioteca  sala_leitura  refeitorio  internet  regular  fund_8_anos  fund_9_anos  em  em_integrado  em_normal  em_prof  codigo_municipio_enorme    codigo_municipios    UF  n_copiadoras  n_arsalas  n_impressoras  n_salas_perm  n_salas_prov  n_sala_util  n_sala_util_fora    codigo_municipio    ufmundv  nomemun  _merge  d_dep1  d_dep2  d_dep3  d_dep4  mais_educ  d_rigor1  d_rigor2  d_rigor3  d_rigor4  media_pb_9  enem_nota_matematica_std    enem_nota_ciencias_std    enem_nota_humanas_std    enem_nota_linguagens_std    media_lp_prova_brasil_9_std    media_mt_prova_brasil_9_std    media_pb_9_std  apr_ef_std  apr_em_std  rep_ef_std  rep_em_std  aba_ef_std  aba_em_std  dist_ef_std  dist_em_std  enem_nota_redacao_std_aux_2003    enem_nota_redacao_std_aux_2004    enem_nota_redacao_std_aux_2005    enem_nota_redacao_std_aux_2006    enem_nota_redacao_std_aux_2007    enem_nota_redacao_std_aux_2008    enem_nota_redacao_std    enem_nota_objetiva_std_aux_2003    enem_nota_objetiva_std_aux_2004    enem_nota_objetiva_std_aux_2005    enem_nota_objetiva_std_aux_2006    enem_nota_objetiva_std_aux_2007    enem_nota_objetiva_std_aux_2008    enem_nota_objetivab    enem_nota_objetivab_std    enem_nota_matematica26_std    enem_nota_ciencias26_std    enem_nota_humanas26_std    enem_nota_linguagens26_std    media_lp_prova_brasil_926_std    media_mt_prova_brasil_926_std    media_pb_926_std    apr_ef26_std  apr_em26_std  rep_ef26_std  rep_em26_std  aba_ef26_std  aba_em26_std  dist_ef26_std  dist_em26_std  enem_nota_matematica52_std    enem_nota_ciencias52_std    enem_nota_humanas52_std    enem_nota_linguagens52_std    media_lp_prova_brasil_952_std    media_mt_prova_brasil_952_std    media_pb_952_std    apr_ef52_std  apr_em52_std  rep_ef52_std  rep_em52_std  aba_ef52_std  aba_em52_std  dist_ef52_std  dist_em52_std  enem_nota_matematica35_std    enem_nota_ciencias35_std    enem_nota_humanas35_std    enem_nota_linguagens35_std    media_lp_prova_brasil_935_std    media_mt_prova_brasil_935_std    media_pb_935_std    apr_ef35_std  apr_em35_std  rep_ef35_std  rep_em35_std  aba_ef35_std  aba_em35_std  dist_ef35_std  dist_em35_std  enem_nota_matematica23_std    enem_nota_ciencias23_std    enem_nota_humanas23_std    enem_nota_linguagens23_std    media_lp_prova_brasil_923_std    media_mt_prova_brasil_923_std    media_pb_923_std    apr_ef23_std  apr_em23_std  rep_ef23_std  rep_em23_std  aba_ef23_std  aba_em23_std  dist_ef23_std  dist_em23_std  enem_nota_matematica33_std    enem_nota_ciencias33_std    enem_nota_humanas33_std    enem_nota_linguagens33_std    media_lp_prova_brasil_933_std    media_mt_prova_brasil_933_std    media_pb_933_std    apr_ef33_std  apr_em33_std  rep_ef33_std  rep_em33_std  aba_ef33_std  aba_em33_std  dist_ef33_std  dist_em33_std  enem_nota_redacao26_std_aux_2003    enem_nota_redacao26_std_aux_2004    enem_nota_redacao26_std_aux_2005    enem_nota_redacao26_std_aux_2006    enem_nota_redacao26_std_aux_2007    enem_nota_redacao26_std_aux_2008    enem_nota_redacao26_std    enem_nota_objetivab26    enem_nota_objetivab26_std    enem_nota_redacao52_std_aux_2003    enem_nota_redacao52_std_aux_2004    enem_nota_redacao52_std_aux_2005    enem_nota_redacao52_std_aux_2006    enem_nota_redacao52_std_aux_2007    enem_nota_redacao52_std_aux_2008    enem_nota_redacao52_std    enem_nota_objetivab52    enem_nota_objetivab52_std    enem_nota_redacao35_std_aux_2003    enem_nota_redacao35_std_aux_2004    enem_nota_redacao35_std_aux_2005    enem_nota_redacao35_std_aux_2006    enem_nota_redacao35_std_aux_2007    enem_nota_redacao35_std_aux_2008    enem_nota_redacao35_std    enem_nota_objetivab35    enem_nota_objetivab35_std    enem_nota_redacao23_std_aux_2003    enem_nota_redacao23_std_aux_2004    enem_nota_redacao23_std_aux_2005    enem_nota_redacao23_std_aux_2006    enem_nota_redacao23_std_aux_2007    enem_nota_redacao23_std_aux_2008    enem_nota_redacao23_std    enem_nota_objetivab23    enem_nota_objetivab23_std    enem_nota_redacao33_std_aux_2003    enem_nota_redacao33_std_aux_2004    enem_nota_redacao33_std_aux_2005    enem_nota_redacao33_std_aux_2006    enem_nota_redacao33_std_aux_2007    enem_nota_redacao33_std_aux_2008    enem_nota_redacao33_std    enem_nota_objetivab33    enem_nota_objetivab33_std    n_alunos_em  n_mulheres_em  n_brancos_em  n_alunos_ef  n_mulheres_ef  n_brancos_ef  n_alunos_ep  n_mulheres_ep  n_brancos_ep  n_alunos_ef_em  n_alunos_em_ep  n_alunos_ef_em_ep    n_mulheres_ef_em_ep    n_brancos_ef_em_ep    d_ice  d_ano1  d_ano2  d_ano3  d_ano4  d_ano5  d_ano6  d_ano7  d_ano8  d_ano9  d_ano10  d_ano11  d_ano12  d_uf1  d_uf2  d_uf3  d_uf4  d_uf5  nalunos  nmulheres  nbrancos  taxa_participacao_enem_aux    taxa_participacao_enem_aux2    taxa_participacao_enem    
save "$folderservidor\ice_clean_fluxo_alavancas.dta", replace

